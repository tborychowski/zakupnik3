<button ref:btnToday class="btn-today" on:click="gotoToday()">Today</button>
<MonthPicker ref:monthPicker on:change="onMonthPickerChange(event.month)"></MonthPicker>
<YearPicker ref:yearPicker on:change="onYearPickerChange(event.year)"></YearPicker>

<script>
import YearPicker from './year-picker';
import MonthPicker from './month-picker';

const today = new Date();
let currentDate;
const format = d => d.toISOString().substr(0, 7);	// yyyy-mm-dd
const isSameDay = (d1, d2) => format(d1) === format(d2);


export default {
	data () { return { isToday: false }; },
	components: { MonthPicker, YearPicker },
	oncreate () { this.goto(); },
	methods: {
		goto (day = today) {
			currentDate = day;
			this.options.target.classList.toggle('is-today', isSameDay(day, today));
		},

		gotoToday () {
			const day = today;
			this.refs.monthPicker.set({ month: day.getMonth() + 1 });
			this.refs.yearPicker.set({ year: day.getFullYear() });
			this.goto();
		},

		onMonthPickerChange (month) {
			const day = new Date(currentDate);
			day.setMonth(month - 1, 1);
			this.refs.yearPicker.set({ year: day.getFullYear() });
			this.goto(day);
		},

		onYearPickerChange (year) {
			const day = new Date(currentDate);
			day.setYear(year);
			this.refs.monthPicker.set({ month: day.getMonth() + 1 });
			this.goto(day);
		}
	}
};
</script>
